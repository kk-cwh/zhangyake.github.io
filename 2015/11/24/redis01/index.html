<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="天空之城,zhangykvip@126.com"><title>redis 命令学习(一) · THIS SPACE</title><meta name="description" content="String操作命令String 是 redis 中最基础的数据类型， redis 字符串是二进制安全的，这意味着他们有一个已知的长度没有任何特殊字符终止，所以你可以存储任何东西，512兆为上限。
SET命令  - 添加键值SET命令是将字符串值 value 关联到 key 。
语法格式：1SET "><meta name="keywords" content="Hexo,HTML,CSS,php,Python,Node.js"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.gif" style="width:127px; border-radius: 100px;"><h3 title=""><a href="/">THIS SPACE</a></h3><div class="description"><p>live a good life.</p></div></div></div><ul class="social-links"><li><a href="/atom.xml"><i class="fa fa-rss"></i></a></li><li><a href="http://weibo.com/http://weibo.com/jaakzh"><i class="fa fa-weibo"></i></a></li><li><a href="http://github.com/https://github.com/zhangyake/"><i class="fa fa-github"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=0 height=0 src="//music.163.com/outchain/player?type=2&id=410042763&auto=1&height=66"></iframe></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"> </a></li></div><div class="avatar"><img src="/images/favicon.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>redis 命令学习(一)</a></h3></div><div class="post-content"><h4 id="String操作命令"><a href="#String操作命令" class="headerlink" title="String操作命令"></a>String操作命令</h4><p>String 是 redis 中最基础的数据类型， redis 字符串是二进制安全的，这意味着他们有一个已知的长度没有任何特殊字符终止，所以你可以存储任何东西，512兆为上限。<br><a id="more"></a></p>
<h4 id="SET命令-添加键值"><a href="#SET命令-添加键值" class="headerlink" title="SET命令  - 添加键值"></a>SET命令  - 添加键值</h4><p>SET命令是将字符串值 value 关联到 key 。</p>
<p>语法格式：<br><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SET key value <span class="string">[EX seconds]</span> <span class="string">[PX milliseconds]</span> <span class="string">[NX|XX]</span></div></pre></td></tr></table></figure></p>
<p> 如果 key 已经持有其他值，SET就覆写旧值，无视类型。因此，对于某个原本带有生存时间（TTL）的键来说， 当SET命令成功在这个键上执行时， 这个键原有的 TTL 将被清除。<br>示例：添加键key1，值为”test”<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">SET</span> <span class="selector-tag">key1</span> "<span class="selector-tag">test</span>"</div><div class="line"><span class="selector-tag">OK</span></div></pre></td></tr></table></figure></p>
<h4 id="SETEX命令-添加值和生存时间"><a href="#SETEX命令-添加值和生存时间" class="headerlink" title="SETEX命令  - 添加值和生存时间"></a>SETEX命令  - 添加值和生存时间</h4><p>　　SETEX命令的作用是将值 value 关联到 key ，并将 key 的生存时间设为 seconds (以秒为单位)。如果 key 已经存在， SETEX命令将覆写旧值<br>语法格式：<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SETEX key <span class="built_in">seconds</span> <span class="built_in">value</span></div></pre></td></tr></table></figure></p>
<p>示例 - 设置name的值为‘jaak’，生存时间为60秒。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">SETEX</span> <span class="selector-tag">name</span> 60 "<span class="selector-tag">jaak</span>"</div><div class="line"><span class="selector-tag">OK</span></div></pre></td></tr></table></figure></p>
<p>SETEX命令的作用类似如下两个命令：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SET</span> <span class="keyword">name</span> <span class="string">"jaak"</span></div><div class="line"><span class="keyword">EXPIRE</span> <span class="keyword">name</span> <span class="number">60</span>  # 设置生存时间</div></pre></td></tr></table></figure></p>
<p>不同之处是，SETEX是一个原子性(atomic)操作， 关联值 和 设置生存时间 两个动作会在同一时间内完成，该命令在 Redis 用作缓存时，非常实用。</p>
<h4 id="GET命令-获取字符串"><a href="#GET命令-获取字符串" class="headerlink" title="GET命令 - 获取字符串"></a>GET命令 - 获取字符串</h4><p>　　GET命令是返回 key 所关联的字符串值。如果 key 不存在那么返回特殊值 nil 。假如 key 储存的值不是字符串类型，返回一个错误，因为GET只能用于处理字符串值<br>语法格式：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="builtin-name">GET</span> key</div></pre></td></tr></table></figure></p>
<p>示例 - 获取name和key的值。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">GET</span> <span class="selector-tag">name</span></div><div class="line">"<span class="selector-tag">jaak</span>"</div><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">GET</span> <span class="selector-tag">key</span></div><div class="line">(<span class="selector-tag">nil</span>)</div><div class="line">返回值</div></pre></td></tr></table></figure></p>
<p>当key不存在时，返回nil，否则返回key的值。<br>如果key的值不是字符串类型，那么将会返回一个错误。</p>
<h4 id="APPEND命令-追加字符串"><a href="#APPEND命令-追加字符串" class="headerlink" title="APPEND命令 - 追加字符串"></a>APPEND命令 - 追加字符串</h4><p>如果 key 已经存在并且是一个字符串，APPEND命令将 value 追加到 key 原来的值的末尾，<br>语法格式：<br><figure class="highlight q"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">APPEND <span class="built_in">key</span> <span class="built_in">value</span></div></pre></td></tr></table></figure></p>
<p>示例 - 向name追加字符‘ zhang’。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">APPEND</span> <span class="selector-tag">name</span> " <span class="selector-tag">zhang</span>"    # 对已存在的字符串进行 <span class="selector-tag">APPEND</span></div><div class="line">(<span class="selector-tag">integer</span>) 10</div><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">GET</span> <span class="selector-tag">name</span></div><div class="line">“<span class="selector-tag">jaak</span> <span class="selector-tag">zhang</span>"</div></pre></td></tr></table></figure>
<p>如果 key 不存在，APPEND就简单地将给定 key 设为 value ，就像执行 SET key value 一样。</p>
<h4 id="MSET命令-添加多个键值"><a href="#MSET命令-添加多个键值" class="headerlink" title="MSET命令 - 添加多个键值"></a>MSET命令 - 添加多个键值</h4><p>　　MSET命令可以同时设置一个或多个 key-value 对，如果某个给定 key 已经存在，那么MSET会用新值覆盖原来的旧值<br>语法格式：<br><figure class="highlight q"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">MSET <span class="built_in">key</span> <span class="built_in">value</span> [<span class="built_in">key</span> <span class="built_in">value</span> ...]</div></pre></td></tr></table></figure></p>
<p>示例 - 设置name、age和number的值。</p>
<p>127.0.0.1:6379&gt; MSET name “jaak” age “24” number “158234232”<br>OK<br>MSET是一个原子性(atomic)操作，所有给定 key 都会在同一时间内被设置，某些给定 key 被更新而另一些给定 key 没有改变的情况，不可能发生。</p>
<h4 id="MGET命令-获取多个键值"><a href="#MGET命令-获取多个键值" class="headerlink" title="MGET命令 - 获取多个键值"></a>MGET命令 - 获取多个键值</h4><p>执行MGET命令，将返回所有(一个或多个)给定 key 的值<br>语法格式：<br><figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">MGET <span class="built_in">key</span> [<span class="built_in">key</span> ...]</div></pre></td></tr></table></figure></p>
<p>示例 - 获取name、age、number  、sex的值。<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">127.0.0.1:6379&gt;</span> MGET name age number  sex</div><div class="line"><span class="number">1</span>) <span class="string">"jaak"</span></div><div class="line"><span class="number">2</span>) <span class="string">"24"</span></div><div class="line"><span class="number">3</span>) <span class="string">"158234232"</span></div><div class="line"><span class="number">4</span>) (<span class="literal">nil</span>)</div></pre></td></tr></table></figure></p>
<p>如果给定的 key 里面，有某个 key 不存在，那么这个 key 返回特殊值 nil 。因此，该命令永不失败。</p>
<h4 id="SETRANGE命令-覆写"><a href="#SETRANGE命令-覆写" class="headerlink" title="SETRANGE命令 - 覆写"></a>SETRANGE命令 - 覆写</h4><p>SETRANGE命令是用 value 参数覆写(overwrite)给定 key 所储存的字符串值，从偏移量offset开始。<br>不存在的 key 当作空白字符串处理,语法格式：<br><figure class="highlight excel"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SETRANGE key <span class="built_in">offset</span> <span class="built_in">value</span></div></pre></td></tr></table></figure></p>
<p>示例 - 覆写name的值。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">SET</span> <span class="selector-tag">name</span> "<span class="selector-tag">jaak</span>"</div><div class="line"><span class="selector-tag">OK</span></div><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">SETRANGE</span> <span class="selector-tag">name</span> 4 "<span class="selector-tag">zhang</span>"</div><div class="line">(<span class="selector-tag">integer</span>) 11</div><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">GET</span> <span class="selector-tag">name</span></div><div class="line">"<span class="selector-tag">jaakzhang</span>"</div></pre></td></tr></table></figure>
<p>SETRANGE命令会确保字符串足够长以便将 value 设置在指定的偏移量上，如果给定 key 原来储存的字符串长度比偏移量小(比如字符串只有 5 个字符长，但你设置的 offset 是 10 )，那么原字符和偏移量之间的空白将用零字节(zerobytes, “\x00” )来填充。<br>注意你能使用的最大偏移量是 2^29-1(536870911) ，因为 Redis 字符串的大小被限制在 512 兆(megabytes)以内。如果你需要使用比这更大的空间，你可以使用多个 key 。</p>
<h4 id="STRLEN命令-获取键值长度"><a href="#STRLEN命令-获取键值长度" class="headerlink" title="STRLEN命令 - 获取键值长度"></a>STRLEN命令 - 获取键值长度</h4><p>STRLEN命令将会返回 key 所储存的字符串值的长度<br>语法格式：<br><figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">STRLEN</span> <span class="built_in">key</span></div></pre></td></tr></table></figure></p>
<p>示例 - 获取name值的长度。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">STRLEN</span> <span class="selector-tag">name</span></div><div class="line">(<span class="selector-tag">integer</span>) 9</div></pre></td></tr></table></figure></p>
<p>值得注意的是当 key 储存的不是字符串值时，返回一个错误。</p>
<h4 id="其他命令"><a href="#其他命令" class="headerlink" title="其他命令"></a>其他命令</h4><p>除了前面提到的那些常用命令以外，还有很多其他的命令，真正用到的时候再来详细了解如何使用它。</p>
<p><strong>命令</strong>              　　　　　　　　　<strong>用途</strong><br><strong>GETSET</strong>  <em>设置键的字符串值，并返回旧值。</em><br><strong>GETRANGE</strong>    <em>得到字符串的子字符串存放在一个键。</em><br><strong>GETBIT</strong>  <em>对 key 所储存的字符串值，获取指定偏移量上的位(bit)。</em><br><strong>SETBIT</strong>  <em>对 key 所储存的字符串值，设置或清除指定偏移量上的位(bit)。</em><br><strong>SETNX</strong>   <em>将 key 的值设为 value ，当且仅当 key 不存在。</em><br><strong>MSETNX</strong>  <em>同时设置一个或多个 key-value 对，当且仅当所有给定 key 都不存在。</em><br><strong>PSETEX</strong>  <em>和 SETEX 命令相似，但它以毫秒为单位设置 key 的生存时间，而不是像 SETEX 命令那样，以秒为单位。</em><br><strong>INCR</strong>    <em>将 key 中储存的数字值增一。</em><br><strong>INCRBY</strong>  <em>将 key 所储存的值加上指定增量。</em><br><strong>INCRBYFLOAT</strong> <em>为 key 中所储存的值加上指定浮点数增量。</em><br><strong>DECR</strong>    <em>将 key 中储存的数字值减一。</em><br><strong>DECRBY</strong>  <em>将 key 所储存的值加上指定增量。</em></p>
<h3 id="哈希（Hash）操作命令"><a href="#哈希（Hash）操作命令" class="headerlink" title="哈希（Hash）操作命令"></a>哈希（Hash）操作命令</h3><p>Redis Hashes是字符串字段和字符串值之间的映射,因此他们是展现对象的完美数据类型。</p>
<h4 id="HSET命令-添加键值"><a href="#HSET命令-添加键值" class="headerlink" title="HSET命令 - 添加键值"></a>HSET命令 - 添加键值</h4><p>　　在 redis 中，使用HSET命令来将哈希表 key 中的域 field 的值设为 value<br>语法如下：<br><figure class="highlight q"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">HSET <span class="built_in">key</span> field <span class="built_in">value</span></div></pre></td></tr></table></figure></p>
<p>示例 - 添加键name ，值为‘jaak zhang’。<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HSET man <span class="built_in">name</span> <span class="string">"jaak zhang"</span> <span class="comment"># 设置一个新域</span></div><div class="line">(<span class="built_in">integer</span>) <span class="number">1</span></div></pre></td></tr></table></figure></p>
<p>如果 key 不存在，一个新的哈希表被创建并进行HSET操作。<br>如果域 field 已经存在于哈希表中，旧值将被覆盖。</p>
<h4 id="HMSET命令-添加多个值"><a href="#HMSET命令-添加多个值" class="headerlink" title="HMSET命令 - 添加多个值"></a>HMSET命令 - 添加多个值</h4><p>除了HSET命令，HMSET命令的用途也是用来设置值，不同的是，HMSET一次可以设置多个 field-value (域-值)对设置到哈希表 key 中,语法如下：<br><figure class="highlight q"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">HMSET <span class="built_in">key</span> field <span class="built_in">value</span> [field <span class="built_in">value</span> ...]</div></pre></td></tr></table></figure></p>
<p>示例 - 添加键age、sex。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">HMSET</span> <span class="selector-tag">man</span> <span class="selector-tag">age</span> "24" <span class="selector-tag">sex</span> "男"</div><div class="line"><span class="selector-tag">OK</span></div></pre></td></tr></table></figure></p>
<p>如果 key 不存在，将会创建一个空的哈希表并执行HMSET操作。<br>如果添加的域已存在哈希表中，那么它将被覆盖。</p>
<h4 id="HGET命令-获取值"><a href="#HGET命令-获取值" class="headerlink" title="HGET命令 - 获取值"></a>HGET命令 - 获取值</h4><p>127.0.0.1:6379 中如何获取key的值呢？HGET是用来获取指定 key 值的命令，语法如下:<br><figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">HGET</span> key <span class="meta">field</span></div></pre></td></tr></table></figure></p>
<p>示例 - 获取域name的值。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">HGET</span> <span class="selector-tag">man</span> <span class="selector-tag">name</span></div><div class="line">"<span class="selector-tag">jaak</span> <span class="selector-tag">zhang</span>"</div></pre></td></tr></table></figure></p>
<p>执行HGET命令，如果 key 存在，将返回哈希表 key 中给定域 field 的值，如果 key 不存在，则返回 (nil) 。</p>
<h4 id="HMGET命令-获取多个值"><a href="#HMGET命令-获取多个值" class="headerlink" title="HMGET命令 - 获取多个值"></a>HMGET命令 - 获取多个值</h4><p>作为HMSET命令对应的获取命令，HMGET可以一次性获取哈希表 key 中，一个或多个给定域的值<br>基本语法：<br><figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">HMGET</span> key <span class="meta">field</span> [<span class="meta">field</span> ...]</div></pre></td></tr></table></figure></p>
<p>示例 - 获取域name、age、sex的值。<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">127.0.0.1:6379&gt;</span> HMGET man  name age sex             </div><div class="line"><span class="comment"># 返回值的顺序和传入参数的顺序一样</span></div><div class="line"><span class="number">1</span>) <span class="string">"jaak zhang"</span></div><div class="line"><span class="number">2</span>) <span class="string">"24"</span></div><div class="line"><span class="number">3</span>) <span class="string">"\xe7\x94\xb7"</span></div></pre></td></tr></table></figure></p>
<p>如果给定的域不存在于哈希表，那么返回一个 nil 值。<br>因为不存在的 key 被当作一个空哈希表来处理，所以对一个不存在的 key 进行HMGET操作将返回一个只带有 nil 值的表。</p>
<h4 id="HGETALL命令-获取全部值"><a href="#HGETALL命令-获取全部值" class="headerlink" title="HGETALL命令 - 获取全部值"></a>HGETALL命令 - 获取全部值</h4><p>如果我们想要一次性获取全部域的值，很显然 HGET 和 HMGET 都是不合适的，所幸的是我们还有HGETALL命令，通过它，我们可以轻松的获取到全部域值，<br>基本语法：<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">HGETALL key</span></div></pre></td></tr></table></figure></p>
<p>示例 - 获取man全部域的值。<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">127.0.0.1:6379&gt;</span>HGETALL man</div><div class="line"><span class="number">1</span>) <span class="string">"name"</span>   <span class="comment">#域</span></div><div class="line"><span class="number">2</span>) <span class="string">"jaak zhang"</span> <span class="comment">#值</span></div><div class="line"><span class="number">3</span>) <span class="string">"age"</span></div><div class="line"><span class="number">4</span>) <span class="string">"24"</span></div><div class="line"><span class="number">5</span>) <span class="string">"sex"</span></div><div class="line"><span class="number">6</span>) <span class="string">"\xe7\x94\xb7"</span></div></pre></td></tr></table></figure></p>
<p>在返回值里，紧跟每个域名(field name)之后是域的值(value)，所以返回值的长度是哈希表大小的两倍。</p>
<h4 id="HEXISTS命令-验证存在"><a href="#HEXISTS命令-验证存在" class="headerlink" title="HEXISTS命令 -  验证存在"></a>HEXISTS命令 -  验证存在</h4><p>在应用环境中，我们经常会需要知道一个 key 中是否存在某个 field ，HEXISTS命令可以帮助我们达到这个目的<br>基本语法：<br><figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">HEXISTS</span> key <span class="meta">field</span></div></pre></td></tr></table></figure></p>
<p>示例 - 验证键number是否存在。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">HEXISTS</span> <span class="selector-tag">man</span> <span class="selector-tag">number</span> </div><div class="line">(<span class="selector-tag">integer</span>) 0</div></pre></td></tr></table></figure></p>
<p>查看哈希表 key 中，给定域 field 是否存在。<br>如果哈希表含有给定域，返回 1 。<br>如果哈希表不含有给定域，或 key 不存在，返回 0 。</p>
<h4 id="HKEYS命令-获取所有key"><a href="#HKEYS命令-获取所有key" class="headerlink" title="HKEYS命令 - 获取所有key"></a>HKEYS命令 - 获取所有key</h4><p>我们经常会遇见这样的应用场景，比如在线用户列表、课堂列表等等，这时候我们可以使用HKEYS来获取哈希表 key 中的所有域<br>基本语法：<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">HKEYS key</span></div></pre></td></tr></table></figure></p>
<p>示例 - 查看键man中所有的域。<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">127.0.0.1:6379&gt;</span> HKEYS man</div><div class="line"><span class="number">1</span>) <span class="string">"name"</span></div><div class="line"><span class="number">2</span>) <span class="string">"age"</span></div><div class="line"><span class="number">3</span>) <span class="string">"sex"</span></div></pre></td></tr></table></figure></p>
<p>当 key 存在时，将返回一个包含哈希表中所有域的表。 当 key 不存在时，返回一个空表。</p>
<h4 id="HLEN命令-获取域数量"><a href="#HLEN命令-获取域数量" class="headerlink" title="HLEN命令 - 获取域数量"></a>HLEN命令 - 获取域数量</h4><p>HLEN命令将返回哈希表 key 中域的数量,什么时候会用到它呢？比如：在线聊天室，显示在线用户数<br>基本语法：<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">HLEN key</span></div></pre></td></tr></table></figure></p>
<p>示例 - 查看man键中域的个数。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">HLEN</span> <span class="selector-tag">man</span></div><div class="line">(<span class="selector-tag">integer</span>) 3</div></pre></td></tr></table></figure></p>
<p>当 key 存在时，将返回哈希表中域的数量。 当 key 不存在时，返回 0 。</p>
<h4 id="HDEL命令-删除"><a href="#HDEL命令-删除" class="headerlink" title="HDEL命令 - 删除"></a>HDEL命令 - 删除</h4><p>有添加就必定有删除的需求，当我们想要删除哈希表 key 中的一个或多个指定域时，可以使用HDEL命令<br>基本语法：<br><figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">HDEL</span> key <span class="meta">field</span> [<span class="meta">field</span> ...]</div></pre></td></tr></table></figure></p>
<p>示例 - 删除键man中的sex域。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:6379</span>&gt; <span class="selector-tag">HDEL</span> <span class="selector-tag">man</span> <span class="selector-tag">sex</span></div><div class="line">(<span class="selector-tag">integer</span>) 1</div></pre></td></tr></table></figure></p>
<p>如果是不存在的域，那么它将被忽略掉。</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2015-11-24</span><i class="fa fa-tag"></i><a href="/categories/数据库/" title="数据库" class="tag">数据库 </a><a href="/tags/redis/" title="redis" class="tag">redis </a></div></div></div></div><div class="share"><div class="evernote"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"><a href="http://twitter.com/home?status=,http://zhangyake.github.io/2015/11/24/redis01/,THIS SPACE,redis 命令学习(一),;" class="fa fa-twitter"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a role="navigation" href="/2015/11/27/redis02/" title="redis命令学习(二)" class="btn">上一篇</a></li><li class="next pagbuttons"><a role="navigation" href="/2015/11/16/mongoose01/" title="mongoose简单总结" class="btn">下一篇</a></li></ul></div><a id="comments"></a><div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div><script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script><script>var cloudTieConfig = { url: document.location.href, sourceId: '2015/11/24/redis01/', productKey: 'zhangykvip@126.com', target: 'cloud-tie-wrapper' };var yunManualLoad = true;Tie.loader("aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vcGMvbGl2ZXNjcmlwdC5odG1s", true);</script></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>